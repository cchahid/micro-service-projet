# ğŸ—ï¸ HEXAGONAL ARCHITECTURE - VISUAL GUIDE

## Your Event-Driven Architecture with Ports & Adapters

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    RESERVATION SERVICE (Domain-Driven)                      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                             â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘  â”‚ CORE DOMAIN (No Infrastructure Dependencies!)                       â”‚   â•‘
â•‘  â”‚                                                                     â”‚   â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚   â•‘
â•‘  â”‚  â”‚  Reservation     â”‚      â”‚  ReservationService  â”‚               â”‚   â•‘
â•‘  â”‚  â”‚  Aggregate       â”‚      â”‚  (Application)       â”‚               â”‚   â•‘
â•‘  â”‚  â”‚                  â”‚      â”‚                      â”‚               â”‚   â•‘
â•‘  â”‚  â”‚ - id: UUID       â”‚      â”‚ - createReservation()               â”‚   â•‘
â•‘  â”‚  â”‚ - dinnerId       â”‚      â”‚ - cancelReservation()               â”‚   â•‘
â•‘  â”‚  â”‚ - guestId        â”‚      â”‚ - updateReservation()               â”‚   â•‘
â•‘  â”‚  â”‚ - status         â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚   â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚                           â”‚   â•‘
â•‘  â”‚                                  Emits Domain Event                â”‚   â•‘
â•‘  â”‚                                        â”‚                           â”‚   â•‘
â•‘  â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚   â•‘
â•‘  â”‚                      â”‚  ReservationCreated            â”‚            â”‚   â•‘
â•‘  â”‚                      â”‚  ReservationCanceled           â”‚            â”‚   â•‘
â•‘  â”‚                      â”‚  (Domain Events)               â”‚            â”‚   â•‘
â•‘  â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚   â•‘
â•‘  â”‚                                        â”‚                           â”‚   â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                                           â”‚                               â•‘
â•‘  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â•‘
â•‘  â•‘ OUTPUT PORT (Interface - Isolates Kafka)                           â•‘   â•‘
â•‘  â•‘                                                                    â•‘   â•‘
â•‘  â•‘  ReservationEventPublisher                                        â•‘   â•‘
â•‘  â•‘  â”œâ”€ publishReservationCreated()                                   â•‘   â•‘
â•‘  â•‘  â””â”€ publishReservationCanceled()                                  â•‘   â•‘
â•‘  â•‘                                                                    â•‘   â•‘
â•‘  â•‘  âœ“ Domain doesn't know about Kafka!                              â•‘   â•‘
â•‘  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â•‘
â•‘                                 â”‚                                       â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â•‘
â•‘  â”‚ INFRASTRUCTURE LAYER                               â”‚               â•‘
â•‘  â”‚                                                    â”‚               â•‘
â•‘  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚               â•‘
â•‘  â”‚ â”‚ Kafka Adapter Implementation                 â”‚  â”‚               â•‘
â•‘  â”‚ â”‚ KafkaReservationEventPublisher               â”‚  â”‚               â•‘
â•‘  â”‚ â”‚ implements ReservationEventPublisher         â”‚  â”‚               â•‘
â•‘  â”‚ â”‚                                              â”‚  â”‚               â•‘
â•‘  â”‚ â”‚ @Component                                   â”‚  â”‚               â•‘
â•‘  â”‚ â”‚ public void publishReservationCreated() {    â”‚  â”‚               â•‘
â•‘  â”‚ â”‚   kafkaTemplate.send("reservation-created",  â”‚  â”‚               â•‘
â•‘  â”‚ â”‚                      event);                 â”‚  â”‚               â•‘
â•‘  â”‚ â”‚ }                                            â”‚  â”‚               â•‘
â•‘  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚               â•‘
â•‘  â”‚                                                    â”‚               â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â•‘
â•‘                                                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                    â”‚
                            Kafka Message Stream
                                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                           â”‚                           â”‚
        â–¼                           â–¼                           â–¼
     Topic:              Topic:                  Topic:
"reservation-created" "reservation-canceled" "*.DLT" (Dead Letter)


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    NOTIFICATION SERVICE (Domain-Driven)                     â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                             â•‘
â•‘  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â•‘
â•‘  â•‘ INPUT PORT (Interface - Isolates Kafka)                            â•‘   â•‘
â•‘  â•‘                                                                    â•‘   â•‘
â•‘  â•‘  NotificationInputPort                                            â•‘   â•‘
â•‘  â•‘  â”œâ”€ handleReservationCreatedEvent()                               â•‘   â•‘
â•‘  â•‘  â”œâ”€ handleReservationCanceledEvent()                              â•‘   â•‘
â•‘  â•‘  â”œâ”€ handleDinnerStartedEvent()                                    â•‘   â•‘
â•‘  â•‘  â”œâ”€ handleDinnerEndedEvent()                                      â•‘   â•‘
â•‘  â•‘  â””â”€ handleGuestCreatedEvent()                                     â•‘   â•‘
â•‘  â•‘                                                                    â•‘   â•‘
â•‘  â•‘  âœ“ Domain logic independent of Kafka!                            â•‘   â•‘
â•‘  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â•‘
â•‘                                 â”‚                                       â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â•‘
â•‘  â”‚ INFRASTRUCTURE LAYER (Kafka Consumer)              â”‚               â•‘
â•‘  â”‚                                                    â”‚               â•‘
â•‘  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚               â•‘
â•‘  â”‚ â”‚ Kafka Adapter                                â”‚  â”‚               â•‘
â•‘  â”‚ â”‚ ReservationEventListener                     â”‚  â”‚               â•‘
â•‘  â”‚ â”‚                                              â”‚  â”‚               â•‘
â•‘  â”‚ â”‚ @KafkaListener(topics="reservation-created")â”‚  â”‚               â•‘
â•‘  â”‚ â”‚ public void consumeReservationCreated(      â”‚  â”‚               â•‘
â•‘  â”‚ â”‚     ReservationCreatedEventDTO event)       â”‚  â”‚               â•‘
â•‘  â”‚ â”‚ {                                           â”‚  â”‚               â•‘
â•‘  â”‚ â”‚   // Extract headers (correlation-id,      â”‚  â”‚               â•‘
â•‘  â”‚ â”‚   // topic, partition, offset)             â”‚  â”‚               â•‘
â•‘  â”‚ â”‚                                             â”‚  â”‚               â•‘
â•‘  â”‚ â”‚   // Call INPUT PORT - domain-agnostic!    â”‚  â”‚               â•‘
â•‘  â”‚ â”‚   notificationInputPort                     â”‚  â”‚               â•‘
â•‘  â”‚ â”‚     .handleReservationCreatedEvent(event)   â”‚  â”‚               â•‘
â•‘  â”‚ â”‚ }                                           â”‚  â”‚               â•‘
â•‘  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚               â•‘
â•‘  â”‚                                                    â”‚               â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â•‘
â•‘                         â”‚                                             â•‘
â•‘                         â–¼                                             â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â•‘
â•‘  â”‚ APPLICATION LAYER (Use Cases)                       â”‚             â•‘
â•‘  â”‚                                                     â”‚             â•‘
â•‘  â”‚ NotificationApplicationService                    â”‚             â•‘
â•‘  â”‚ implements NotificationInputPort                  â”‚             â•‘
â•‘  â”‚                                                     â”‚             â•‘
â•‘  â”‚ @Transactional                                     â”‚             â•‘
â•‘  â”‚ public void handleReservationCreatedEvent(        â”‚             â•‘
â•‘  â”‚     ReservationCreatedEventDTO event)             â”‚             â•‘
â•‘  â”‚ {                                                  â”‚             â•‘
â•‘  â”‚   // Pure business logic - no Kafka!              â”‚             â•‘
â•‘  â”‚                                                    â”‚             â•‘
â•‘  â”‚   Guest guest = guestPersistencePort              â”‚             â•‘
â•‘  â”‚     .findById(event.getGuestId());                â”‚             â•‘
â•‘  â”‚                                                    â”‚             â•‘
â•‘  â”‚   Notification notification =                     â”‚             â•‘
â•‘  â”‚     notificationDomainService                     â”‚             â•‘
â•‘  â”‚       .createNewNotification(...);                â”‚             â•‘
â•‘  â”‚                                                    â”‚             â•‘
â•‘  â”‚   notificationPersistencePort.save(...);          â”‚             â•‘
â•‘  â”‚   notificationSenderPort.sendNotification(...);   â”‚             â•‘
â•‘  â”‚ }                                                  â”‚             â•‘
â•‘  â”‚                                                     â”‚             â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â•‘
â•‘                         â”‚                                            â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â•‘
â•‘  â”‚                                       â”‚               â”‚           â•‘
â•‘  â–¼                                       â–¼               â–¼           â•‘
â•‘                                                                      â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ OUTPUT PORT 1        â”‚  â”‚ OUTPUT PORT 2        â”‚  â”‚OUTPUT PORT3   â•‘
â•‘  â”‚                      â”‚  â”‚                      â”‚  â”‚         3      â•‘
â•‘  â”‚NotificationSenderPortâ”‚  â”‚NotificationPersist  â”‚  â”‚GuestPersist  â•‘
â•‘  â”‚                      â”‚  â”‚encePort             â”‚  â”‚Port            â•‘
â•‘  â”‚ - sendNotification() â”‚  â”‚                      â”‚  â”‚                â•‘
â•‘  â”‚                      â”‚  â”‚ - save()             â”‚  â”‚ - findById()   â•‘
â•‘  â”‚ âœ“ Email interface    â”‚  â”‚ - findPending()      â”‚  â”‚ - save()       â•‘
â•‘  â”‚   (abstracted!)      â”‚  â”‚                      â”‚  â”‚                â•‘
â•‘  â”‚                      â”‚  â”‚ âœ“ Database interface â”‚  â”‚âœ“ Lookup user   â•‘
â•‘  â”‚                      â”‚  â”‚   (abstracted!)      â”‚  â”‚ (abstracted!)  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
â•‘             â”‚                         â”‚                       â”‚
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
â•‘  â”‚ ADAPTER 1             â”‚  â”‚ ADAPTER 2              â”‚  â”‚ADAPTER 3   â”‚
â•‘  â”‚                       â”‚  â”‚                        â”‚  â”‚           â”‚
â•‘  â”‚SmtpNotificationSender â”‚  â”‚JPANotificationRepository  â”‚JPAGuest   â”‚
â•‘  â”‚implements Sender Port â”‚  â”‚implements Persistence â”‚ Repository     â”‚
â•‘  â”‚                       â”‚  â”‚Port                    â”‚  â”‚           â”‚
â•‘  â”‚ @Component            â”‚  â”‚ @Repository            â”‚  â”‚@Repository â”‚
â•‘  â”‚ public void send() {  â”‚  â”‚ extends JpaRepository  â”‚  â”‚ extends    â”‚
â•‘  â”‚   mailSender.send()   â”‚  â”‚ {                      â”‚  â”‚JpaRepository
â•‘  â”‚ }                     â”‚  â”‚   @Query("SELECT...")  â”‚  â”‚ {          â”‚
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ }                      â”‚  â”‚ }          â”‚
â•‘                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â•‘                             
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â•‘  â”‚ CORE DOMAIN (No Infrastructure!)                â”‚
â•‘  â”‚                                                  â”‚
â•‘  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â•‘  â”‚ â”‚ Notification   â”‚   â”‚NotificationDomain   â”‚   â”‚
â•‘  â”‚ â”‚ Aggregate      â”‚   â”‚Service              â”‚   â”‚
â•‘  â”‚ â”‚                â”‚   â”‚                     â”‚   â”‚
â•‘  â”‚ â”‚ - id: UUID     â”‚   â”‚createNewNotification()  â”‚
â•‘  â”‚ â”‚ - userId       â”‚   â”‚                     â”‚   â”‚
â•‘  â”‚ â”‚ - email        â”‚   â”‚ âœ“ Pure business!    â”‚   â”‚
â•‘  â”‚ â”‚ - subject      â”‚   â”‚ âœ“ No Spring!        â”‚   â”‚
â•‘  â”‚ â”‚ - description  â”‚   â”‚ âœ“ No Kafka!         â”‚   â”‚
â•‘  â”‚ â”‚ - status       â”‚   â”‚ âœ“ No Database!      â”‚   â”‚
â•‘  â”‚ â”‚ - channel      â”‚   â”‚ âœ“ No SMTP!          â”‚   â”‚
â•‘  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â•‘  â”‚                                                  â”‚
â•‘  â”‚ These know NOTHING about:                       â”‚
â•‘  â”‚ - Kafka topics, partitions, offsets             â”‚
â•‘  â”‚ - SMTP, email sending                           â”‚
â•‘  â”‚ - HTTP, REST APIs                               â”‚
â•‘  â”‚ - JPA, SQL, databases                           â”‚
â•‘  â”‚ - Spring framework                              â”‚
â•‘  â”‚                                                  â”‚
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ”„ COMPLETE MESSAGE FLOW WITH PORTS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: USER CREATES RESERVATION                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    User API Call
           â”‚
           â–¼
    ReservationController
           â”‚
           â–¼
    ReservationService (Application)
           â”‚
           â–¼
    Create Reservation (Domain Aggregate)
           â”‚
    Emit Domain Event: ReservationCreated
           â”‚


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: APPLICATION SERVICE PUBLISHES EVENT                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    ReservationApplicationService
           â”‚
           â–¼
    Call OUTPUT PORT:
    ReservationEventPublisher
    .publishReservationCreated()
           â”‚
    âœ“ Domain doesn't know
      this is Kafka!
           â”‚


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: ADAPTER PUBLISHES TO KAFKA                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    KafkaReservationEventPublisher (Adapter)
    implements ReservationEventPublisher
           â”‚
           â–¼
    kafkaTemplate.send("reservation-created", event)
           â”‚
           â–¼
    Kafka Topic: "reservation-created"
    â”œâ”€ Partition 0
    â”œâ”€ Partition 1
    â””â”€ Partition 2
           â”‚


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: NOTIFICATION SERVICE CONSUMES EVENT                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Kafka Topic (reservation-created)
           â”‚
           â–¼
    ReservationEventListener (Adapter)
    @KafkaListener(topics="reservation-created")
           â”‚
    Extracts Kafka Headers:
    â”œâ”€ correlation-id
    â”œâ”€ topic
    â”œâ”€ partition
    â””â”€ offset
           â”‚


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 5: ADAPTER CALLS INPUT PORT                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    ReservationEventListener
           â”‚
           â–¼
    Call INPUT PORT:
    notificationInputPort
    .handleReservationCreatedEvent(event)
           â”‚
    âœ“ Domain doesn't know
      this came from Kafka!
           â”‚


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 6: APPLICATION SERVICE PROCESSES EVENT                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    NotificationApplicationService (Application)
    implements NotificationInputPort
           â”‚
           â–¼
    Pure Business Logic:
    1. Find guest by ID
    2. Create notification
    3. Save to DB
    4. Send email
           â”‚
    âœ“ No Kafka knowledge!
           â”‚


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 7: SERVICE USES OUTPUT PORTS                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    NotificationApplicationService
           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”
    â”‚      â”‚      â”‚
    â–¼      â–¼      â–¼
    
    OUTPUT PORT 1    OUTPUT PORT 2      OUTPUT PORT 3
    NotificationSender  NotificationPersistence  GuestPersistence
           â”‚              â”‚                      â”‚
           â–¼              â–¼                      â–¼
    
    ADAPTER 1          ADAPTER 2              ADAPTER 3
    SmtpNotification   JPARepository        JPARepository
    Sender             (Database)           (Guest lookup)
           â”‚              â”‚                      â”‚
           â–¼              â–¼                      â–¼
    
    Send Email    Save to DB            Lookup Guest
           â”‚              â”‚                      â”‚
           â–¼              â–¼                      â–¼
    
    SMTP Server    PostgreSQL         Database
           â”‚              â”‚
           â–¼              â–¼
    Email Sent!    Notification Saved!
```

---

## ğŸ§ª STANDALONE PROTOTYPE - TEST VALIDATION

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ INTEGRATION TEST (Embedded Kafka - No External Services!)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

@SpringBootTest
@EmbeddedKafka(
    partitions = 3,
    topics = {
        "reservationCreated",
        "reservationCanceled",
        "reservation-created.DLT",
        "reservation-canceled.DLT"
    }
)
class ReservationEventListenerIntegrationTest {
    
    âœ“ Test 1: Event Deserialization
      â””â”€ Verifies ReservationCreatedEventDTO structure
      
    âœ“ Test 2: Event Cancellation
      â””â”€ Verifies ReservationCanceledEventDTO structure
      
    âœ“ Test 3: Correlation Headers
      â””â”€ Verifies tracing with correlation-id
      
    âœ“ Test 4: Event with Kafka Headers
      â””â”€ Verifies topic, partition, offset extraction
}

Benefits:
âœ“ Runs independently (Embedded Kafka)
âœ“ No external Kafka broker needed
âœ“ No network calls
âœ“ Fast feedback
âœ“ Validates event flow before integration
âœ“ Catches deserialization issues
âœ“ Tests headers handling
âœ“ Regression prevention
```

---

## âœ¨ SUMMARY: Your Ports & Adapters Architecture

```
RESERVATION SERVICE
â”œâ”€ Domain Layer (Pure Business)
â”‚  â”œâ”€ Reservation Aggregate
â”‚  â””â”€ ReservationCreated Event
â”œâ”€ Application Layer
â”‚  â””â”€ ReservationApplicationService
â”œâ”€ OUTPUT PORT
â”‚  â””â”€ ReservationEventPublisher (Interface)
â””â”€ Adapter Layer
   â””â”€ KafkaReservationEventPublisher (Kafka Implementation)
   
              â†“ Kafka Topic â†“
              
NOTIFICATION SERVICE
â”œâ”€ INPUT PORT
â”‚  â””â”€ NotificationInputPort (Interface)
â”œâ”€ Adapter Layer
â”‚  â””â”€ ReservationEventListener (Kafka Consumer)
â”œâ”€ Application Layer
â”‚  â””â”€ NotificationApplicationService (Implements Port)
â”œâ”€ OUTPUT PORTS
â”‚  â”œâ”€ NotificationSenderPort
â”‚  â”œâ”€ NotificationPersistencePort
â”‚  â””â”€ GuestPersistencePort
â”œâ”€ Adapter Layer
â”‚  â”œâ”€ SmtpNotificationSender
â”‚  â”œâ”€ JPANotificationRepository
â”‚  â””â”€ JPAGuestRepository
â””â”€ Domain Layer (Pure Business)
   â”œâ”€ Notification Aggregate
   â””â”€ NotificationDomainService
```

---

**Architecture Pattern:** âœ… Hexagonal (Ports & Adapters)
**Domain Isolation:** âœ… Complete (No framework knowledge in domain)
**Testability:** âœ… Excellent (Can mock all ports)
**Flexibility:** âœ… High (Can swap adapters)
**Standalone Prototype:** âœ… Integrated tests with embedded Kafka


